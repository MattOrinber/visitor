<html xmlns:util="urn:jsptagdir:/WEB-INF/tags/util" xmlns:jsp="http://java.sun.com/JSP/Page" xmlns:decorator="http://www.opensymphony.com/sitemesh/decorator" xmlns:c="http://java.sun.com/jsp/jstl/core" xmlns:security="http://www.springframework.org/security/tags" xmlns:spring="http://www.springframework.org/tags" xmlns:form="http://www.springframework.org/tags/form">

<jsp:output omit-xml-declaration="yes" />
<jsp:directive.page contentType="text/html; charset=UTF-8" />

<head>
</head>
<body>
	<span class="ui-state-highlight button button-show">排行榜</span>
	<a href="${pageContext.request.contextPath}/domain/productrank/new?siteId=${rankSearchForm.siteId}" class="ajaxy button button-search">最新榜</a>

	<form:form action="${pageContext.request.contextPath}/domain/productrank/show" modelAttribute="rankSearchForm" method="post">
	<form:hidden path="siteId"/>
		<table class="show">
			<tbody>
				<tr>
					<th>
						<spring:message code="folder_folderId" />
					</th>
					<td>
						<form:select path="folderId">
							<form:option value=""><spring:message code="NULL" /></form:option>
							<form:options items="${folders}" itemValue="value" itemLabel="label" />
						</form:select>
						<form:errors path="folderId" cssClass="error" />
					</td>
					<th>
						榜单类型
					</th>
					<td>
						<form:select path="type">
							<form:option value="5">日下载</form:option>
							<form:option value="1">周下载</form:option>
							<form:option value="3">月下载</form:option>
							<form:option value="6">最新</form:option>
						</form:select>
						<form:errors path="type" cssClass="error" />
					</td>
				</tr>
				<tr>
					<th>
						<spring:message code="site_platformId" />
					</th>
					<td>
						<form:select path="version">
							<form:options items="${versions}" itemValue="categoryId" itemLabel="name" />
						</form:select>
						<form:errors path="version" cssClass="error" />
					</td>
					<th>
						分辨率等级
					</th>
					<td>
						<form:select path="level">
							<form:option value="1">153600以上</form:option>
							<form:option value="2">76800以上</form:option>
							<form:option value="3">其他</form:option>
						</form:select>
						<form:errors path="level" cssClass="error" />
					</td>
				</tr>
			</tbody>
			<tfoot>
				<tr>
					<td colspan="4">
						<input type="submit" class="button button-search" value="查询" />
					</td>
				</tr>
			</tfoot>
		</table>
	</form:form>
	<table class="list">
		<thead>
			<tr>
				<th style="width:8%"><util:sort-header model="productList" attribute="productId" url="list" /></th>
				<th><util:sort-header model="productList" attribute="name" url="list" /></th>
				<th style="width:20%"><spring:message code="productList_folder" /></th>
				<th><util:sort-header model="productState" attribute="dailyDl" url="list" /></th>
				<th><util:sort-header model="productState" attribute="weekDl" url="list" /></th>
				<th><util:sort-header model="productState" attribute="monthDl" url="list" /></th>
			</tr>
		</thead>
		<tbody>
			<c:forEach items="${productLists}" var="productList" varStatus="_st">
				<tr>
					<td>${productList.productId}</td>
					<td><a href="${pageContext.request.contextPath}/domain/productlist/show/${productList.productId}"><spring:eval expression="productList.name"/></a></td>
					<td>
						<c:forEach items="${productList.folders}" var="folder" varStatus="status">
							<c:if test="${status.index != 0}"><br/></c:if>
								<a href="${pageContext.request.contextPath}/domain/folder/show/${folder.primaryKey}">${folder.name}</a>
						</c:forEach>
					</td>
					<td>
						<c:if test="${rankSearchForm.type==5}"><font color="red"><strong>${productList.productState.dailyDl}</strong></font></c:if>
						<c:if test="${rankSearchForm.type!=5}">${productList.productState.dailyDl}</c:if>
					</td>
					<td>
						<c:if test="${rankSearchForm.type==1}"><font color="red"><strong>${productList.productState.weekDl}</strong></font></c:if>
						<c:if test="${rankSearchForm.type!=1}">${productList.productState.weekDl}</c:if>
					</td>
					<td>
						<c:if test="${rankSearchForm.type==3}"><font color="red"><strong>${productList.productState.monthDl}</strong></font></c:if>
						<c:if test="${rankSearchForm.type!=3}">${productList.productState.monthDl}</c:if>
					</td>
				</tr>
			</c:forEach>
		</tbody>
		<tfoot>
			<tr>
				<th colspan="2"></th>
				<th colspan="2">
					<util:navigation totalSize="${1000}" search="${rankSearchForm.sp}" url="show" totalPages="${10}" render="${1000 > 0}" />
				</th>
				<th><spring:message code="search.total" arguments="${1000}" /></th>
			</tr>
		</tfoot>
	</table>
</body>
</html>