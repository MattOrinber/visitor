<html xmlns:util="urn:jsptagdir:/WEB-INF/tags/util" xmlns:jsp="http://java.sun.com/JSP/Page" 
xmlns:decorator="http://www.opensymphony.com/sitemesh/decorator" xmlns:c="http://java.sun.com/jsp/jstl/core" 
xmlns:form="http://www.springframework.org/tags/form" xmlns:security="http://www.springframework.org/security/tags" 
xmlns:spring="http://www.springframework.org/tags" version="2.0">
<jsp:output omit-xml-declaration="yes" />
<jsp:directive.page contentType="text/html; charset=UTF-8" />
<head>
	<title><spring:message code="category" />: <spring:message code="crud.functionalities.update" /></title>
</head>
<body>
	<a href="${pageContext.request.contextPath}/domain/category/search"	class="ajaxy button button-search"><spring:message code="category" /></a>
	<a href="${pageContext.request.contextPath}/domain/category/show/${category.primaryKey}" class="ajaxy button button-show">
		<spring:message code="crud.show.button" /></a>
	<span class="ui-state-highlight button button-edit"><spring:message code="crud.edit.button" /> </span>
	<a href="${pageContext.request.contextPath}/domain/category/delete/${category.primaryKey}" class="modal button button-delete">
		<spring:message code="crud.delete.button" /></a>
	<div id="category">
	
		<a href="#"	onclick="openInDiv('${pageContext.request.contextPath}/domain/category/createChild/${category.primaryKey}','create',event)"
			class="ajaxy button button-create"><spring:message code="crud.functionalities.create" /><spring:message code="category_child_category" />
		</a>
		<a href="${pageContext.request.contextPath}/domain/category/delete/${category.primaryKey}" class="modal button button-delete">
			<spring:message code="crud.delete.button" />
		</a>
		<input type="hidden" id="thread" name="thread" value="${nsThread}" />
		<form:form onsubmit="return validate()"	action="${pageContext.request.contextPath}/domain/category/update/${category.primaryKey}"
			modelAttribute="category" method="POST">
			<form:errors cssClass="error" />
			<form:hidden path="categoryId" />
			<form:hidden path="status" />
			
			<spring:eval expression="category.parentCategoryId" javaScriptEscape="true" var="parentCategoryValue"/>
			<input type="hidden" id="parentCategoryId" name="parentCategoryId" value="${parentCategoryValue}" />
			<spring:eval expression="category.name" javaScriptEscape="true" var="oldnameValue"/>
			<input type="hidden" name="oldname" value="${oldnameValue}" />
			<spring:eval expression="category.enName" javaScriptEscape="true" var="oldennameValue"/>
			<input type="hidden" name="oldenname" value="${oldennameValue}" />
			<table class="edit">
				<tbody>
					<tr>
						<th>
							<spring:message code="category_parent" />
						</th>
						<td>
							<c:out value="${category.parentCategory.name}" escapeXml="true"/>
						</td>
					</tr>					
					<tr>
						<th>
							<spring:message code="category_parentCategoryId" />
						</th>
						<td>
							<c:out value="${category.parentCategory.categoryId}" escapeXml="true"/>
						</td>
					</tr>
					<tr>
						<th><spring:message code="category_categoryId" /></th>
						<td>
							<c:out value="${category.categoryId}" escapeXml="true"/>
						</td>
					</tr>
					<tr>
						<th>
							<spring:message code="category_name" />
							<em>*</em>
						</th>
						<td>
							<form:input path="name" cssClass="required {maxlength: 200}"
								maxlength="200" size="80" />
							<form:errors path="name" cssClass="error" />
						</td>
					</tr>
					<tr>
						<th>
							<spring:message code="category_enName" />
						</th>
						<td>
							<form:input path="enName" cssClass="{maxlength: 200}"
								maxlength="200" size="80" />
							<form:errors path="enName" cssClass="error" />
							<br />
							<spring:message code="category_note" />
						</td>
					</tr>
					<tr>
						<th>
							<spring:message code="category_description" />
						</th>
						<td>
							<form:input path="description" cssClass="{maxlength: 255}"
								maxlength="255" size="80" />
							<form:errors path="description" cssClass="error" />
						</td>
					</tr>
					<tr>
						<th><spring:message code="category_sortOrder" /><em>*</em></th>
						<td>
							<form:input path="sortOrder" cssClass="number required {maxlength: 2}" maxlength="2" size="80"/>
							<form:errors path="sortOrder" cssClass="error"/>
						</td>
					</tr>

					<c:if test="${nsThread == 3 &amp;&amp; (nsRight-nsLeft) == 1}">
					<tr>
						<th>
							<spring:message code="category_dic_resolution" />
						</th>
						<td>
						<select name="resolution">
							<option value=""></option>
							<c:forEach items="${resolutions}" var="res">
								<c:if test="${res.categoryId == resolution.categoryId}">
									<option value="${res.categoryId}" selected="selected">${res.name}</option>
								</c:if>
								<c:if test="${res.categoryId != resolution.categoryId}">
									<option value="${res.categoryId}">${res.name}</option>
								</c:if>
							</c:forEach>
						</select>
						</td>
					</tr>
					</c:if>

				</tbody>
				<tfoot>
					<tr>
						<td colspan="2">
							<spring:message code="crud.save.button" var="buttonValue" />
							<input type="submit" class="button button-save" value="${buttonValue}"/>
						</td>
					</tr>
				</tfoot>
			</table>
		</form:form>
	</div>
</body>
</html>