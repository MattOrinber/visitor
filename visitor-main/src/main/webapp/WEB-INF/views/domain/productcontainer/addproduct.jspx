<html xmlns:util="urn:jsptagdir:/WEB-INF/tags/util" xmlns:jsp="http://java.sun.com/JSP/Page" xmlns:decorator="http://www.opensymphony.com/sitemesh/decorator" xmlns:c="http://java.sun.com/jsp/jstl/core"  xmlns:fmt="http://java.sun.com/jsp/jstl/fmt" xmlns:form="http://www.springframework.org/tags/form" xmlns:security="http://www.springframework.org/security/tags" xmlns:spring="http://www.springframework.org/tags">

<jsp:output omit-xml-declaration="yes" />
<jsp:directive.page contentType="text/html; charset=UTF-8" />

<head>
	<title><spring:message code="productContainer" />: <spring:message code="crud.functionalities.create" /></title>
	<script type="text/javascript">
	$(function() {
		$("#siteId")
				.change(
						function() {
							var siteId = $(this).val();
							$.ajax( {
										type : "GET",
										url : "${pageContext.request.contextPath}/domain/folder/folderList/" + siteId,
										success : function(ss) {
											var arr = eval(ss);
											cleanSelect(document.getElementById("folderId"));
											cleanSelect(document.getElementById("pageId"));
											freshSelect(document.getElementById("folderId"),arr);
										}
									})
						})
		$("#folderId")
				.change(
						function() {
							var siteId = $(this).val();
							$.ajax( {
										type : "GET",
										url : "${pageContext.request.contextPath}/domain/htmlpage/pageList/"
												+ siteId,
										success : function(ss) {
											var arr = eval(ss);
											cleanSelect(document.getElementById("pageId"));
											freshSelect(document.getElementById("pageId"),arr);
										}
									})
						})
		$("#pageId")
				.change(
						function() {
							var siteId = $(this).val();
							$
									.ajax( {
										type : "GET",
										url : "${pageContext.request.contextPath}/domain/pagecontainer/containerList/"
												+ siteId,
										success : function(ss) {
											var arr = eval(ss);
											cleanSelect(document.getElementById("containerId"));
											freshSelect(document.getElementById("containerId"),arr);
										}
									})
						})
	})
	function cleanSelect(selectObj) {
		var count = selectObj.options.length;
		for ( var i = count - 1; i &gt;= 0; i--) {
			selectObj.options[i] = null;
		}
		selectObj.options.add(new Option("<spring:message code='button_select' />", ""));
	}
	function freshSelect(selectObj, arr) {
		for ( var i = 0; i &lt; arr.length; i++) {
			selectObj.options.add(new Option(arr[i].key, arr[i].value));
		}
	}
</script>
</head>
<body>
	<a href="${pageContext.request.contextPath}/domain/recommandcontainer/search" class="ajaxy button button-search"><spring:message code="recommandContainer" /></a>
	<a href="${pageContext.request.contextPath}/domain/recommandcontainer/show/${productContainer.containerId}" class="ajaxy button button-show"><spring:message code="crud.show.button" /></a>
	<a href="${pageContext.request.contextPath}/domain/recommandcontainer/update/${productContainer.containerId}" class="ajaxy button button-edit"><spring:message code="crud.edit.button" /></a>
	<span class="ui-state-highlight button button-create"><spring:message code="recommandContainer_add" /></span>

	<form:form action="${pageContext.request.contextPath}/domain/recommandcontainer/addproduct" modelAttribute="productContainer" method="POST">
		<form:errors cssClass="error"/>
		<form:hidden path="productContainerId"/>
		<table class="create">
			<tbody>
				<tr>
					<th><spring:message code="productContainer_containerId" /> <em>*</em></th>
					<td>
						<spring:eval expression="productContainer.containerId" javaScriptEscape="true" var="containerValue" />
						<input type="hidden" id="container" name="container" value="${containerValue}" />
						${productContainer.container.name}
						<form:errors path="container" cssClass="error"/>
					</td>
				</tr>
				<tr>
					<th><spring:message code="productContainer_siteId" /> <em>*</em></th>
					<td>
						<c:choose>
							<c:when test="${productContainer.site != null}">
								<input type="hidden" id="site" name="site" value="${productContainer.siteId}" />
								${productContainer.site.name}
							</c:when>
							<c:otherwise>
								<form:select path="siteId">
									<form:option value=""><spring:message code="button_select" /></form:option>
									<form:options items="${siteList}" itemValue="siteId" itemLabel="name" />
								</form:select>
							</c:otherwise>
						</c:choose>
						<form:errors path="siteId" cssClass="error"/>
					</td>
				</tr>
				<tr>
					<th><spring:message code="productContainer_folderId" /> <em>*</em></th>
					<td>
						<c:choose>
							<c:when test="${productContainer.folder != null}">
								<input type="hidden" id="folder" name="folder" value="${productContainer.folderId}" />
								${productContainer.folder.name}
							</c:when>
							<c:otherwise>
								<form:select path="folderId">
									<form:option value=""><spring:message code="button_select" /></form:option>
									<form:options items="${folderList}" itemValue="value" itemLabel="label" />
								</form:select>
							</c:otherwise>
						</c:choose>
						<form:errors path="folderId" cssClass="error"/>
					</td>
				</tr>
				<tr>
					<th><spring:message code="productContainer_pageId" /> <em>*</em></th>
					<td>
						<c:choose>
							<c:when test="${productContainer.page != null}">
								<input type="hidden" id="page" name="page" value="${productContainer.pageId}" />
								${productContainer.page.name}
							</c:when>
							<c:otherwise>
								<form:select path="pageId">
									<form:option value=""><spring:message code="button_select" /></form:option>
									<form:options items="${pageList}" itemValue="pageId" itemLabel="name" />
								</form:select>
							</c:otherwise>
						</c:choose>
						<form:errors path="pageId" cssClass="error"/>
					</td>
				</tr>
				<tr>
					<th><spring:message code="productContainer_productId" /> <em>*</em></th>
					<td>
						<input type="text" id="product" name="productIds" class="required {maxlength: 200}" maxlength="200"  size="80" value="${product}"/>
						<form:errors path="productId" cssClass="error"/>
					</td>
				</tr>
				<tr>
					<th><spring:message code="productContainer_startDate" /></th>
					<td>
						<form:input path="startDate" cssClass="datepicker" size="11"/>
						<form:errors path="startDate" cssClass="error"/>
					</td>
				</tr>
				<tr>
					<th><spring:message code="productContainer_endDate" /></th>
					<td>
						<form:input path="endDate" cssClass="datepicker" size="11"/>
						<form:errors path="endDate" cssClass="error"/>
					</td>
				</tr>
			</tbody>
			<tfoot>
				<tr>
					<td colspan="2">
						<spring:message code="crud.save.button" var="btnMsg" />
						<input type="submit" class="button button-save" value="${btnMsg}"/>
					</td>
				</tr>
			</tfoot>
		</table>
	</form:form>
</body>
</html>