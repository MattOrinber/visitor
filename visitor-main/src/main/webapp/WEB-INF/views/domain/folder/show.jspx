<html 
	xmlns:util="urn:jsptagdir:/WEB-INF/tags/util" xmlns:jsp="http://java.sun.com/JSP/Page"
 	xmlns:decorator="http://www.opensymphony.com/sitemesh/decorator"
  	xmlns:c="http://java.sun.com/jsp/jstl/core" xmlns:form="http://www.springframework.org/tags/form"
   	xmlns:security="http://www.springframework.org/security/tags"
   	xmlns:fmt="http://java.sun.com/jsp/jstl/fmt" xmlns:spring="http://www.springframework.org/tags" version="2.0">
	<jsp:output omit-xml-declaration="yes" />
	<jsp:directive.page contentType="text/html; charset=UTF-8" />
	<head>
		<title><spring:message code="folder" />: <spring:message code="crud.functionalities.show" /></title>
	</head>
	<body>
	
		<div id="folder_result">
			<a href="${pageContext.request.contextPath}/domain/folder/search" class="ajaxy button button-search"><spring:message code="folder" /></a>
			<span class="ui-state-highlight button button-show"><spring:message code="crud.show.button" /></span>
			<a href="${pageContext.request.contextPath}/domain/folder/update/${folder.primaryKey}" class="ajaxy button button-edit"><spring:message code="crud.edit.button" /></a>
			<a href="${pageContext.request.contextPath}/domain/folder/child/${folder.primaryKey}" class="ajaxy button button-show"><spring:message code="folder_child" /></a>
			<!-- the information of current folder -->
			<table class="show">
				<tbody>
					<tr>
						<th><spring:message code="folder_folderId" /></th>
						<td><c:out value="${folder.folderId}"/></td>
						<th><spring:message code="folder_path" /></th>
						<td><c:out value="${folder.path}"/></td>
					</tr>
					<tr>
						<th><spring:message code="folder_name" /></th>
						<td style="width:38%"><a href="${pageContext.request.contextPath}/domain/folder/show/${folder.primaryKey}" ><c:out value="${folder.name}"/></a></td>
						<th><spring:message code="folder_aliasName" /></th>
						<td style="width:38%"><c:out value="${folder.aliasName}"/></td>
					</tr>
					<tr>
						<th><spring:message code="folder_siteId" /></th>
						<td>
							<a href="${pageContext.request.contextPath}/domain/site/show/${folder.site.primaryKey}" ><c:out value="${folder.site.name}" /></a>
						</td>
						<th><spring:message code="folder_parentFolderId" /></th>
						<td>
							<c:if test="${folder.parentFolder != null}">
								<a href="${pageContext.request.contextPath}/domain/folder/show/${folder.parentFolder.primaryKey}" ><c:out value="${folder.parentFolder.name}" /></a>
							</c:if>
						</td>
					</tr>
					<tr>
						<th><spring:message code="folder_status" /></th>
						<c:if test="${folder.status == 0}"><td><spring:message code="folder_status_yes" /></td></c:if>
						<c:if test="${folder.status == 1}"><td><spring:message code="folder_status_no" /></td></c:if>
						<th><spring:message code="folder_miniLab" /></th>
						<c:if test="${folder.miniLab == 1}"><td><spring:message code="folder_miniLab_hot" /></td></c:if>
						<c:if test="${folder.miniLab == 2}"><td><spring:message code="folder_miniLab_new" /></td></c:if>
						<c:if test="${folder.miniLab == null || folder.miniLab == ''}"><td><spring:message code="NULL" /></td></c:if>
					</tr>
					<tr>
						<th><spring:message code="folder_createBy" /></th>
						<td><c:out value="${folder.createBy}"/></td>
						<th><spring:message code="folder_createDate" /></th>
						<td><c:out value="${folder.createDate}"/></td>
					</tr>
					<tr>
						<th><spring:message code="folder_modBy" /></th>
						<td><c:out value="${folder.modBy}"/></td>
						<th><spring:message code="folder_modDate" /></th>
						<td><c:out value="${folder.modDate}"/></td>
					</tr>
					<tr>
						<th><spring:message code="folder_description" /></th>
						<td><c:out value="${folder.description}"/></td>
						<th><spring:message code="folder_picId" /></th>
						<td>
							<c:if test="${folder.pic != null}">
								<a href="${pageContext.request.contextPath}/domain/picture/show/${folder.pic.primaryKey}"><img src="${picDomain}${folder.pic.path}" height="36" width="36" /></a>
							</c:if>
						</td>
					</tr>
					<c:if test="${folder.folderType == 1}">
						<tr>
							<th><spring:message code="folder_tag" /></th>
							<td colspan="3">
								<c:if test="${folder.tag != null}">
									<c:out value="${folder.tag.name}"/><font color="red">(<spring:message code="folder_tagId" />)</font> 
								</c:if>
								<c:forEach items="${folder.tags}" var="tag" varStatus="status">
									<c:if test="${tag.categoryId != folder.tag.categoryId}">
										${tag.name} 
								</c:if>
								</c:forEach>
								<a href="${pageContext.request.contextPath}/domain/folder/tag/${folder.primaryKey}/" class="button button-edit"><spring:message code="folder_page_operate_edit"/></a>
							</td>
						</tr>
					</c:if>
				</tbody>
				<tfoot>
					<tr>
						<td colspan="4">
							<a href="${pageContext.request.contextPath}/domain/init/redis/folder/${folder.primaryKey}"
								class="modal button"><spring:message code="crud.redis.publish.button" />
							</a>
							<a href="${pageContext.request.contextPath}/domain/init/redis/folder/product/list/${folder.primaryKey}"
								class="modal button"><spring:message code="crud.redis.products.list.button" />
							</a>
							<a href="${pageContext.request.contextPath}/domain/init/redis/folder/product/${folder.primaryKey}"
								class="modal button"><spring:message code="crud.redis.products.button" />
							</a>
							<a href="${pageContext.request.contextPath}/domain/init/redis/search/product/${folder.primaryKey}"
								class="modal button"><spring:message code="crud.redis.products.search.button" />
							</a>
						</td>
					</tr>
				</tfoot>
			</table>	
			<!-- the information of the pages of the folder -->
			<table class="show">
				<thead>
					<tr>
						<th style="width:15%"><spring:message code="folder_page_title_name" /></th>
						<th style="width:10%"><spring:message code="folder_page_title_type" /></th>
						<th style="width:10%"><spring:message code="folder_page_title_publish" /></th>
						<th style="width:10%"><spring:message code="folder_page_title_publishBy" /></th>
						<th><spring:message code="folder_page_title_publishDate" /></th>
						<th><spring:message code="folder_page_title_operate" /></th>
					</tr>
				</thead>
				<tbody>
					<!-- all four pages -->
					<c:forEach items="${pagesOfFolder}" var="pages" varStatus="status">
						<tr>
							<th><spring:message code="folder_${pages.key}PageId" /></th>
							<c:set value="${pages.value}" var="pageItem" />
							<c:choose>
								<c:when test="${pageItem != null}">
									<c:choose>
										<c:when test="${pateItem.ifDefaultPage}">
											<td><spring:message code="folder_page_title_type_default" /></td>
										</c:when>
										<c:otherwise>
											<td><spring:message code="folder_page_title_type_person" /></td>
										</c:otherwise>
									</c:choose>
									<c:choose>
										<c:when test="${pageItem.publishStatus == 1}">
											<td><spring:message code="htmlPage_ifDefaultPage_true" /></td>
										</c:when>
										<c:otherwise>
											<td><spring:message code="htmlPage_ifDefaultPage_false" /></td>
										</c:otherwise>
									</c:choose>
									<td><c:out value="${pageItem.publishBy}"/></td>
									<td><c:out value="${pageItem.publishDate}"/></td>
									<td>
										<a href="${pageContext.request.contextPath}/domain/htmlpage/edit/${folder.primaryKey}/${status.index}/0/" class="button button-edit">
											<spring:message code="folder_page_operate_edit"/>
										</a>
										<a href="${pageContext.request.contextPath}/domain/htmlpage/edit/${folder.primaryKey}/${status.index}/1/" class="button button-edit">
											<spring:message code="folder_page_operate_visual_edit"/>
										</a>
										<a href="${pageContext.request.contextPath}/domain/htmlpage/publish/${pageItem.primaryKey}" class="button button-show">
											<spring:message code="htmlPage_publish"/>
										</a>
										<a onclick="window.open ('${pageContext.request.contextPath}/domain/htmlpage/preview/${pageItem.primaryKey}')" href="#" class="button button-show">
											<spring:message code="htmlPage_preview"/>
										</a>
									</td>
								</c:when>
								<c:otherwise>
									<td colspan="4"><spring:message code="folder_page_no"/></td>
									<td><a href="${pageContext.request.contextPath}/domain/htmlpage/edit/${folder.primaryKey}/${status.index}/0/" class="button button-edit"><spring:message code="folder_page_operate_edit"/></a><a onclick="window.open('${pageContext.request.contextPath}/domain/htmlpage/preview/${indexHtmlPage.primaryKey}')" href="#" class="button button-show"><spring:message code="htmlPage_preview"/></a></td>
								</c:otherwise>
							</c:choose>
						</tr>
					</c:forEach>  
				</tbody>
			</table>
			<!-- productList of the folder -->
			<c:if test="${folder.folderType == 1}">
				<span class="ui-state-highlight button button-show"><spring:message code="folder_product_show" /></span>
				<c:if test="${!empty productSiteFolders}">
					<a href="${pageContext.request.contextPath}/domain/folder/product?folderId=${folder.primaryKey}" class="ajaxy button button-show"><spring:message code="folder_product_more" /></a>
				</c:if>
				<a href="${pageContext.request.contextPath}/domain/folder/addproduct?folderId=${folder.primaryKey}" class="ajaxy button button-create"><spring:message code="folder_product_add" /></a>
				<table class="edit">
					<thead>
						<tr>
							<th style="width:8%"><spring:message code="productList_productId" /></th>
							<th><spring:message code="productList_name" /></th>
							<th><spring:message code="productList_downStatus" /></th>
							<th><spring:message code="productList_billingType" /></th>
							<th><spring:message code="productList_category" /></th>
							<th><spring:message code="productList_modDate" /></th>
							<th><spring:message code="productSiteFolder_sortOrder" /></th>
							<th><spring:message code="productSiteFolder_unbind" /></th>
						</tr>
					</thead>
					<tbody>
						<c:choose>
							<c:when test="${!empty productSiteFolders}">
								<c:forEach items="${productSiteFolders}" var="productSiteFolder" varStatus="status">
									<tr>
										<td>
											${productSiteFolder.product.productId}
										</td>
										<td>
											<a href="${pageContext.request.contextPath}/domain/productlist/show/${productSiteFolder.product.productId}">${productSiteFolder.product.name}</a>
										</td>
										<td>
											<c:if test="${productSiteFolder.product.downStatus==0}"><spring:message code="productList_status_enable" /></c:if>
											<c:if test="${productSiteFolder.product.downStatus==1}"><font color="red"><spring:message code="productList_status_disable" /></font></c:if>
										</td>						
										<td>
											${productSiteFolder.product.billingType.name}
										</td>
										<td>
											${productSiteFolder.product.category.name}
										</td>
										<td>
											<fmt:formatDate value="${productSiteFolder.product.modDate}" type="date" pattern="yyyy-MM-dd"/>
										</td>
										<td><c:out value="${productSiteFolder.sortOrder}" /></td>
										<td>
											<a href="${pageContext.request.contextPath}/domain/productsitefolder/update/${productSiteFolder.primaryKey}" class="button button-edit miniature"><spring:message code="crud.edit.button"/></a>
				
											<a href="${pageContext.request.contextPath}/domain/productsitefolder/delete1/${productSiteFolder.primaryKey}" class="button button-delete modal miniature"><spring:message code="crud.delete.button"/></a>
										</td>
									</tr>
								</c:forEach>
							</c:when>
							<c:otherwise>
								<tr><td colspan="6"><spring:message code="folder_product_none" /></td></tr>
							</c:otherwise>
						</c:choose>
						</tbody>
				</table>
			</c:if>
		<!-- 产品推荐 -->
		<span id="tab_folder" class="ui-state-highlight button"><spring:message code="folderContainer" /></span>
		<a
			href="${pageContext.request.contextPath}/domain/productcontainer/create/${folder.primaryKey}/2"
			class="button button-create"><spring:message code="crud.functionalities.create" /> </a>
		<table class="list">
			<thead>
				<tr>
					<th style="width:10%">
						<spring:message code="productContainer_site" />
					</th>
					<th style="width:17%">
						<spring:message code="productContainer_folder" />
					</th>
					<th style="width:18%">
						<spring:message code="productContainer_container" />
					</th>
					<th>
						<spring:message code="productContainer_page" />
					</th>
					<th>
						<spring:message code="productContainer_sortOrder" />
					</th>
					<th>
						<spring:message code="productContainer_createBy" />
					</th>
					<th>
						<spring:message code="productContainer_createDate" />
					</th>
					<th><c:out value=" " /></th>
				</tr>
			</thead>
			<tbody>
				<c:forEach items="${recommandList}" var="recommand" varStatus="_st">
					<tr>
						<td>
							<a
								href="${pageContext.request.contextPath}/domain/site/show/${recommand.site.primaryKey}">
								<c:out value="${recommand.site.name}" /> </a>
						</td>
						<td>
							<a
								href="${pageContext.request.contextPath}/domain/folder/show/${recommand.folder.primaryKey}">
								<c:out value="${recommand.folder.name}" /> </a>
						</td>
						<td>
							<a
								href="${pageContext.request.contextPath}/domain/recommandcontainer/show/${recommand.container.primaryKey}">
								<c:out value="${recommand.container.name}" /> </a>
						</td>
						<td>
							<c:out value="${recommand.page.name}" />
						</td>
	
						<td>
							<c:out value="${recommand.sortOrder}" />
						</td>
						<td>
							<c:out value="${recommand.createBy}" />
						</td>
						<td>
							<fmt:formatDate value="${recommand.createDate}" type="date" pattern="yyyy-MM-dd" />
						</td>
						<td>
							<a href="${pageContext.request.contextPath}/domain/productcontainer/update/${recommand.primaryKey}" class="button">
								<spring:message code="crud.edit.button" /> 
							</a>
							<a href="${pageContext.request.contextPath}/domain/productcontainer/delete/${recommand.primaryKey}" class="button button-delete modal miniature">
								<spring:message code="crud.delete.button" /> 
							</a>
						</td>
					</tr>
				</c:forEach>
			</tbody>
		</table>
		</div>
	</body>
</html>