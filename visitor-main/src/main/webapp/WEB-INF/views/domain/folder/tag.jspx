<html xmlns:util="urn:jsptagdir:/WEB-INF/tags/util" xmlns:jsp="http://java.sun.com/JSP/Page" 
xmlns:decorator="http://www.opensymphony.com/sitemesh/decorator" xmlns:c="http://java.sun.com/jsp/jstl/core" 
xmlns:form="http://www.springframework.org/tags/form" xmlns:security="http://www.springframework.org/security/tags" 
xmlns:spring="http://www.springframework.org/tags" xmlns:fn="http://java.sun.com/jsp/jstl/functions" version="2.0">
<jsp:output omit-xml-declaration="yes" />
<jsp:directive.page contentType="text/html; charset=UTF-8" />
<head>
	<title><spring:message code="folder" />: <spring:message code="crud.functionalities.update" /></title>
	<style type="text/css">
		.tag_s {color:#F80700;font-weight:700;background:#DCF7FF;}
		.tag_main {color:#F80700;font-weight:700;background:#50BEFF;}
	</style>
	<script type="text/javascript">
	
		$(document).ready(function() {
			init();
			
			$("input[type='checkbox']").click(function(){
				if($(this).attr("checked") == true){
					$("#" + $(this).val() + "_lab").attr("class","tag_s");
					addChecked($(this).val());
				} else {
					$("#" + $(this).val() + "_lab").removeAttr("class");
					delChecked($(this).val());
				}
         	 });
			
			$("#tag").change(function(){
				$("div[type]").attr("class","tag_s").removeAttr("type");
				tag_id = $(this).val();
				$("#" + tag_id + "_lab").attr("type","main").attr("class","tag_main");
				
			});
			
			$("#clear").click(function(){
				$("input[type='checkbox']").each(function(){
					if($(this).attr("checked") == true){
						$(this).click();
						$("#" + $(this).val() + "_lab").removeAttr("class");
						delChecked($(this).val());
					}
				});
			});
		});
		
		function init(){
				
			$("input[type='checkbox']").each(function(){
				if($(this).attr("checked") == true){
					$("#" + $(this).val() + "_lab").attr("class","tag_s");
				} else {
					$("#" + $(this).val() + "_lab").removeAttr("class");
				}
         	 });
         	 
         	 $("#" + $("#tag").val() + "_lab").attr("type","main").attr("class","tag_main");
		}
		
		function addChecked(tagId){
			var text = $("#" + tagId + "_lab").text();
			$("#tag").append("<option value=" + tagId + ">" + text + "</option>");
			$("#" + $("#tag").val() + "_lab").attr("type","main").attr("class","tag_main");
		}
		
		function delChecked(tagId){
			$("option[value=" + tagId +"]").remove();
			$("div[type]").removeAttr("type");
			$("#" + $("#tag").val() + "_lab").attr("type","main").attr("class","tag_main");
		}
		
	</script>
</head>
<body>
	<a href="${pageContext.request.contextPath}/domain/folder/search" class="ajaxy button button-search"><spring:message code="folder" /></a>
	<a href="${pageContext.request.contextPath}/domain/folder/show/${folder.primaryKey}" class="ajaxy button button-show"><spring:message code="crud.show.button" /></a>
	<span class="ui-state-highlight button button-edit"><spring:message code="folder_tag" /></span>

	<form:form action="${pageContext.request.contextPath}/domain/folder/tag/${folder.primaryKey}" modelAttribute="folder" method="POST">
		<form:errors cssClass="error"/>
		<form:hidden path="folderId"/>
		<table class="edit">
			<tbody>
				<tr>
					<th><spring:message code="folder_tag" /></th>
					<td>
					<table>
						<tr>
							<td>
						<c:forEach items="${categorys}" var="category" varStatus="status">
								<div id="${category.categoryId}_lab" style="float:left;width:120px;">
								<c:choose>
									<c:when test="${fn:contains(folder.tags,category)}">
										<input type="checkbox" id="${category.categoryId}" name="tagls" value="${category.categoryId}" checked="checked"/>
									</c:when>
									<c:otherwise>
										<input type="checkbox" id="${category.categoryId}" name="tagls" value="${category.categoryId}" />
									</c:otherwise>
								</c:choose>
								${category.name}
								<c:if test="${(status.index+1)%5 == 0}"><br/></c:if>
								</div>
						</c:forEach>
							</td>
						</tr>
						<form:errors path="tags" cssClass="error"/>
					</table>
					</td>
				</tr>
				<tr>
					<th><spring:message code="folder_tagId" /></th>
					<td>
						<select id="tag" name="tagId">
							<option value="" />
							<c:forEach items="${folder.tags}" var="category" varStatus="status">
								<c:if test="${category == folder.tag}">
									<option value="${category.categoryId}" selected="selected" />${category.name}
								</c:if>
								<c:if test="${category != folder.tag}">
									<option value="${category.categoryId}" />${category.name}
								</c:if>
							</c:forEach>
						</select>
						<form:errors path="tagId" cssClass="error" />
					</td>
				</tr>
			</tbody>
			<tfoot>
				<tr>
					<td colspan="2">
						<spring:message code="crud.save.button" var="saveButton"/>
						<input type="submit" class="button button-save" value="${saveButton}" />
						<spring:message code="crud.clear.button" var="clearButton"/>
						<input id="clear" type="button" class="button button-save" value="${clearButton}" />
					</td>
				</tr>
			</tfoot>
		</table>
	</form:form>
</body>
</html>