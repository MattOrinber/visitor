<html xmlns:util="urn:jsptagdir:/WEB-INF/tags/util" xmlns:jsp="http://java.sun.com/JSP/Page" 
xmlns:decorator="http://www.opensymphony.com/sitemesh/decorator" xmlns:c="http://java.sun.com/jsp/jstl/core" 
xmlns:form="http://www.springframework.org/tags/form" xmlns:security="http://www.springframework.org/security/tags" 
xmlns:spring="http://www.springframework.org/tags" version="2.0">
<jsp:output omit-xml-declaration="yes" />
<jsp:directive.page contentType="text/html; charset=UTF-8" />
<head>
	<title><spring:message code="folder" />: <spring:message code="crud.functionalities.example" /></title>
<script type="text/javascript">
	function bind(productId) {
		$.ajax( {
			type : "GET",
			url : "${pageContext.request.contextPath}/domain/productsitefolder/bind?pid=" + productId + "&amp;folderId=${folder.folderId}",
			success : function(ss) {
				var result = eval(ss);
				if(result.flag){
					window.document.location.href="${pageContext.request.contextPath}/domain/folder/show/${folder.folderId}";
				}else{
					alert(result.err);
				}
			}
		})
	}
</script>
</head>
<body>
<a href="${pageContext.request.contextPath}/domain/folder/show/${folder.folderId}" class="ajaxy button button-show"><spring:message code="crud.show.button" /><spring:message code="folder" /></a>
<a href="${pageContext.request.contextPath}/domain/folder/product?folderId=${folder.folderId}" class="ajaxy button button-show"><spring:message code="folder_product_more" /></a>
<span class="ui-state-highlight button button-create"><spring:message code="folder_product_add" /></span>

	<form:form action="${pageContext.request.contextPath}/domain/folder/addproduct?folderId=${folder.folderId}" modelAttribute="productListSearchForm" class="search">
		<table class="show">
			<tbody>
				<tr>
					<th>
						<spring:message code="productList_productId" />
					</th>
					<td>
						<form:input path="productList.productId" cssClass="number"/>
						<form:errors path="productList.productId" cssClass="error" />
					</td>
					<th>
						<spring:message code="productList_name" />
					</th>
					<td>
						<form:input path="productList.name" />
						<form:errors path="productList.name" cssClass="error" />
					</td>
				</tr>
				<tr>
					<th>
						<spring:message code="productList_createBy" />
					</th>
					<td>
						<form:select path="productList.createBy">
							<form:option value=""><spring:message code="ANY" /></form:option>
							<form:options items="${createByList}" />
						</form:select>
						<form:errors path="productList.createBy" cssClass="error" />
					</td>
					<th>
						<spring:message code="productList_createDate" />
					</th>
					<td>
						<label for="createDateRange.fromDate">
							<spring:message code="search.date.from" />
						</label>
						<form:input path="createDateRange.fromDate" cssClass="datepicker" />
						<label for="createDateRange.toDate">
							<spring:message code="search.date.to" />
						</label>
						<form:input path="createDateRange.toDate" cssClass="datepicker" />
						<form:errors path="productList.createDate" cssClass="error" />
					</td>
				</tr>
				<tr>
					<th>
						<spring:message code="productList_productSource" />
					</th>
					<td>
						<form:select path="productList.sourceId">
							<form:option value="" ><spring:message code="ANY" /></form:option>
							<form:options items="${productSourceList}" itemValue="categoryId" itemLabel="name" />
						</form:select>
					</td>
					<th>
						<spring:message code="productList_downStatus" />
					</th>
					<td>
						<form:select path="productList.downStatus">
							<form:option value="" select="select"><spring:message code="ANY" /></form:option>
							<form:option value="0"><spring:message code="productList_status_enable" /></form:option>
							<form:option value="1"><spring:message code="productList_status_disable" /></form:option>
						</form:select>
					</td>
				</tr>
				<tr>
					<th>
						<spring:message code="productList_importBy" />
					</th>
					<td>
						<form:select path="productList.importBy">
							<form:option value=""><spring:message code="ANY" /></form:option>
							<form:options items="${importByList}" itemValue="categoryId" itemLabel="name" />
						</form:select>
						<form:errors path="productList.importBy" cssClass="error" />
					</td>
					<th>
						<spring:message code="productList_downReason" />
					</th>
					<td>
						<form:input path="productList.downReason" />
						<form:errors path="productList.downReason" cssClass="error" />
					</td>
				</tr>
				<tr>
					<th>
						<spring:message code="productList_cooperationModel" />
					</th>
					<td>
						<form:select path="productList.cooperationModelId">
							<form:option value=""><spring:message code="ANY" /></form:option>
							<form:options items="${cooperationList}" itemValue="categoryId" itemLabel="name" />
						</form:select>
						<form:errors path="productList.cooperationModelId" cssClass="error" />
					</td>
					<th>
						<spring:message code="productList_operationModel" />
					</th>
					<td>
						<form:select path="productList.operationModelId">
							<form:option value=""><spring:message code="ANY" /></form:option>
							<form:options items="${operationList}" itemValue="categoryId" itemLabel="name" />
						</form:select>
						<form:errors path="productList.operationModelId" cssClass="error" />
					</td>
				</tr>
				<tr>
					<th>
						<spring:message code="productList_category" />
					</th>
					<td>
						<form:select path="productList.categoryId">
							<form:option value="" ><spring:message code="ANY" /></form:option>
							<form:options items="${productCategoryList}" itemValue="value" itemLabel="label" />
						</form:select>
						<form:errors path="productList.categoryId" cssClass="error" />
					</td>
					<th>
						<spring:message code="productList_operator" />
					</th>
					<td>
						<form:select path="productList.operatorId">
							<form:option value=""><spring:message code="ANY" /></form:option>
							<form:options items="${operatorList}" itemValue="categoryId" itemLabel="name" />
						</form:select>
						<form:errors path="productList.operatorId" cssClass="error" />
					</td>
				</tr>
			</tbody>
			<tfoot>
				<tr>
					<td colspan="4">
						<spring:message code="crud.search.button" var="buttonSearchValue"/>
						<input type="submit" class="button button-search" value="${buttonSearchValue}" />
					</td>
				</tr>
			</tfoot>
		</table>
	</form:form>
	<div id="result">
		<c:choose>
			<c:when test="${productListsCount == 0}">
				<spring:message code="crud.search.empty.result" />
			</c:when>
			<c:otherwise>
				<table class="list">
					<thead>
						<tr>
							<th>
								<util:sort-header model="productList" attribute="productId"	url="add" />
							</th>
							<th>
								<util:sort-header model="productList" attribute="name" url="add" />
							</th>
							<th>
								<util:sort-header model="productList" attribute="categoryId" url="add" />
							</th>
							<th>
								<util:sort-header model="productList" attribute="billingTypeId" url="add" />
							</th>
							<th>
								<util:sort-header model="productList" attribute="downStatus" url="add" />
							</th>
							<th>
								<util:sort-header model="productList" attribute="createBy" url="add" />
							</th>
							<th>
								<util:sort-header model="productList" attribute="createDate" url="add" />
							</th>
							<th>
								 
							</th>
						</tr>
					</thead>
					<tbody>
						<c:forEach items="${productLists}" var="productList" varStatus="_st">
							<tr>
								<td>
									<spring:eval expression="productList.productId" />
								</td>
								<td>
									<a href="${pageContext.request.contextPath}/domain/productlist/show/${productList.productId}"><spring:eval expression="productList.name" /></a>
								</td>
								<td>
									<spring:eval expression="productList.category.name" />
								</td>
								<td>
									<spring:eval expression="productList.billingType.name" />
								</td>
								<td>
									<c:if test="${productList.downStatus==0}"><spring:message code="productList_status_enable" /></c:if>
									<c:if test="${productList.downStatus==1}"><font color="red"><spring:message code="productList_status_disable" /></font></c:if>
								</td>
								<td>
									<spring:eval expression="productList.createBy" />
								</td>
								<td>
									<spring:eval expression="productList.createDate" />
								</td>
								<td>
									<c:if test="${folder.siteId != null}">
									<spring:message code="crud.bind.button" var="buttonSaveButton"/>
									<input type="submit" class="button button-save" value="${buttonSaveButton}" onclick="javascript:bind('${productList.productId}')" />
									</c:if>
								</td>
							</tr>
						</c:forEach>
					</tbody>
					<tfoot>
						<tr>
							<th colspan="6">
								<util:navigation totalSize="${productListsCount}" search="${productListSearchForm.sp}" url="addproduct" totalPages="${totalPages}" render="${productListsCount > 0}" />
							</th>
							<th><spring:message code="search.total" arguments="${productListsCount}" /></th>
						</tr>
						<tr>
							<td colspan="9">
								<a href="${pageContext.request.contextPath}/domain/folder/show/${folder.folderId}" class="button"><spring:message code="return"/></a>
							</td>
						</tr>
					</tfoot>
				</table>
			</c:otherwise>
		</c:choose>
	</div>
</body>
</html>